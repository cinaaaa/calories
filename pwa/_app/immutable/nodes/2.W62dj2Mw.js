import{a as E,f as x,c as De,t as Ge}from"../chunks/C561E-ns.js";import{e as ce,t as Xe,h as I,z as ve,$ as Ze,v as Qe,F as f,w as je,x as $e,y as Ee,A as ue,i as ee,a7 as ea,aO as aa,aB as Ae,c as B,aV as L,f as ge,aW as ta,s as ra,X as la,aX as na,aN as _e,aY as sa,aZ as ia,D as oa,an as Ce,a_ as ca,r as Me,p as Fe,a$ as de,b0 as va,aL as ua,d as da,a8 as fa,b1 as ha,aS as ga,k as pa,am as ba,b2 as _a,ak as b,ai as p,aj as g,ag as J,aa as K,ah as G,aC as le,aU as U,a9 as ne,u as ma,G as C,aT as P}from"../chunks/BTEy9aSn.js";import{d as $,a as V,s as M,e as xe}from"../chunks/G6TKI36t.js";import{i as H,p as ya,s as wa,a as qe}from"../chunks/3Y_szzPt.js";import{r as te}from"../chunks/D27MAts_.js";import{w as Ie}from"../chunks/mOigczVO.js";function Ke(e,a){return a}function ka(e,a,t){for(var r=[],o=a.length,s,i=a.length,l=0;l<o;l++){let h=a[l];Fe(h,()=>{if(s){if(s.pending.delete(h),s.done.add(h),s.pending.size===0){var d=e.outrogroups;pe(_e(s.done)),d.delete(s),d.size===0&&(e.outrogroups=null)}}else i-=1},!1)}if(i===0){var u=r.length===0&&t!==null;if(u){var n=t,v=n.parentNode;ua(v),v.append(n),e.items.clear()}pe(a,!u)}else s={pending:new Set(a),done:new Set},(e.outrogroups??=new Set).add(s)}function pe(e,a=!0){for(var t=0;t<e.length;t++)da(e[t],a)}var Ne;function Oe(e,a,t,r,o,s=null){var i=e,l=new Map;{var u=e;i=I?ve(Ze(u)):u.appendChild(ce())}I&&Qe();var n=null,v=la(()=>{var m=t();return na(m)?m:m==null?[]:_e(m)}),h,d=!0;function _(){y.fallback=n,Sa(y,h,i,a,r),n!==null&&(h.length===0?(n.f&L)===0?Me(n):(n.f^=L,Q(n,null,i)):Fe(n,()=>{n=null}))}var c=Xe(()=>{h=f(v);var m=h.length;let k=!1;if(I){var w=je(i)===$e;w!==(m===0)&&(i=Ee(),ve(i),ue(!1),k=!0)}for(var q=new Set,A=B,D=ra(),W=0;W<m;W+=1){I&&ee.nodeType===ea&&ee.data===aa&&(i=ee,k=!0,ue(!1));var F=h[W],T=r(F,W),S=d?null:l.get(T);S?(S.v&&Ae(S.v,F),S.i&&Ae(S.i,W),D&&A.unskip_effect(S.e)):(S=Ea(l,d?i:Ne??=ce(),F,T,W,o,a,t),d||(S.e.f|=L),l.set(T,S)),q.add(T)}if(m===0&&s&&!n&&(d?n=ge(()=>s(i)):(n=ge(()=>s(Ne??=ce())),n.f|=L)),m>q.size&&ta(),I&&m>0&&ve(Ee()),!d)if(D){for(const[R,X]of l)q.has(R)||A.skip_effect(X.e);A.oncommit(_),A.ondiscard(()=>{})}else _();k&&ue(!0),f(v)}),y={effect:c,items:l,outrogroups:null,fallback:n};d=!1,I&&(i=ee)}function Z(e){for(;e!==null&&(e.f&va)===0;)e=e.next;return e}function Sa(e,a,t,r,o){var s=a.length,i=e.items,l=Z(e.effect.first),u,n=null,v=[],h=[],d,_,c,y;for(y=0;y<s;y+=1){if(d=a[y],_=o(d,y),c=i.get(_).e,e.outrogroups!==null)for(const T of e.outrogroups)T.pending.delete(c),T.done.delete(c);if((c.f&L)!==0)if(c.f^=L,c===l)Q(c,null,t);else{var m=n?n.next:l;c===e.effect.last&&(e.effect.last=c.prev),c.prev&&(c.prev.next=c.next),c.next&&(c.next.prev=c.prev),O(e,n,c),O(e,c,m),Q(c,m,t),n=c,v=[],h=[],l=Z(n.next);continue}if((c.f&de)!==0&&Me(c),c!==l){if(u!==void 0&&u.has(c)){if(v.length<h.length){var k=h[0],w;n=k.prev;var q=v[0],A=v[v.length-1];for(w=0;w<v.length;w+=1)Q(v[w],k,t);for(w=0;w<h.length;w+=1)u.delete(h[w]);O(e,q.prev,A.next),O(e,n,q),O(e,A,k),l=k,n=A,y-=1,v=[],h=[]}else u.delete(c),Q(c,l,t),O(e,c.prev,c.next),O(e,c,n===null?e.effect.first:n.next),O(e,n,c),n=c;continue}for(v=[],h=[];l!==null&&l!==c;)(u??=new Set).add(l),h.push(l),l=Z(l.next);if(l===null)continue}(c.f&L)===0&&v.push(c),n=c,l=Z(c.next)}if(e.outrogroups!==null){for(const T of e.outrogroups)T.pending.size===0&&(pe(_e(T.done)),e.outrogroups?.delete(T));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||u!==void 0){var D=[];if(u!==void 0)for(c of u)(c.f&de)===0&&D.push(c);for(;l!==null;)(l.f&de)===0&&l!==e.fallback&&D.push(l),l=Z(l.next);var W=D.length;if(W>0){var F=s===0?t:null;ka(e,D,F)}}}function Ea(e,a,t,r,o,s,i,l){var u=(i&sa)!==0?(i&ia)===0?oa(t,!1,!1):Ce(t):null,n=(i&ca)!==0?Ce(o):null;return{v:u,i:n,e:ge(()=>(s(a,u??t,n??o,l),()=>{e.delete(r)}))}}function Q(e,a,t){if(e.nodes)for(var r=e.nodes.start,o=e.nodes.end,s=a&&(a.f&L)===0?a.nodes.start:t;r!==null;){var i=fa(r);if(s.before(r),r===o)return;r=i}}function O(e,a,t){a===null?e.effect.first=t:a.next=t,t===null?e.effect.last=a:t.prev=a}const We=[...` 	
\r\f \v\uFEFF`];function Aa(e,a,t){var r=e==null?"":""+e;if(t){for(var o in t)if(t[o])r=r?r+" "+o:o;else if(r.length)for(var s=o.length,i=0;(i=r.indexOf(o,i))>=0;){var l=i+s;(i===0||We.includes(r[i-1]))&&(l===r.length||We.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function Ca(e,a){return e==null?null:String(e)}function Le(e,a,t,r,o,s){var i=e.__className;if(I||i!==t||i===void 0){var l=Aa(t,r,s);(!I||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=t}else if(s&&o!==s)for(var u in s){var n=!!s[u];(o==null||n!==!!o[u])&&e.classList.toggle(u,n)}return s}function xa(e,a,t,r){var o=e.__style;if(I||o!==a){var s=Ca(a);(!I||s!==e.getAttribute("style"))&&(s==null?e.removeAttribute("style"):e.style.cssText=s),e.__style=a}return r}function re(e,a,t=a){var r=new WeakSet;ha(e,"input",async o=>{var s=o?e.defaultValue:e.value;if(s=fe(e)?he(s):s,t(s),B!==null&&r.add(B),await ga(),s!==(s=a())){var i=e.selectionStart,l=e.selectionEnd,u=e.value.length;if(e.value=s??"",l!==null){var n=e.value.length;i===l&&l===u&&n>u?(e.selectionStart=n,e.selectionEnd=n):(e.selectionStart=i,e.selectionEnd=Math.min(l,n))}}}),(I&&e.defaultValue!==e.value||pa(a)==null&&e.value)&&(t(fe(e)?he(e.value):e.value),B!==null&&r.add(B)),ba(()=>{var o=a();if(e===document.activeElement){var s=_a??B;if(r.has(s))return}fe(e)&&o===he(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function fe(e){var a=e.type;return a==="number"||a==="range"}function he(e){return e===""?null:+e}var qa=x('<header class="header svelte-1elxaub"><div class="header-logo svelte-1elxaub" aria-hidden="true"></div> <h1 class="header-title svelte-1elxaub">Calories</h1> <button type="button" class="header-menu svelte-1elxaub" aria-label="Open menu"><span class="header-menu-dots svelte-1elxaub" aria-hidden="true"><span class="dot svelte-1elxaub"></span><span class="dot svelte-1elxaub"></span><span class="dot svelte-1elxaub"></span><span class="dot svelte-1elxaub"></span></span></button></header>');function Na(e,a){var t=qa(),r=b(p(t),4);g(t),V("click",r,function(...o){a.onMenuClick?.apply(this,o)}),E(e,t)}$(["click"]);var Wa=x('<div class="hero svelte-hqmxak"><p class="hero-total svelte-hqmxak"><span class="hero-number svelte-hqmxak"> </span> <span class="hero-unit svelte-hqmxak">Kcal</span></p> <p class="hero-allowance svelte-hqmxak">Daily allowance: <strong class="svelte-hqmxak"> </strong></p></div>');function Ta(e,a){J(a,!0);var t=Wa(),r=p(t),o=p(r),s=p(o,!0);g(o),le(2),g(r);var i=b(r,2),l=b(p(i)),u=p(l,!0);g(l),g(i),g(t),K(n=>{M(s,n),M(u,a.dailyAllowance)},[()=>a.totalCalories.toLocaleString("en-US")]),E(e,t),G()}var Da=x('<div><span class="chart-pct svelte-31511h"> </span> <div class="chart-bar-wrap svelte-31511h"><div class="chart-bar target svelte-31511h" title="Target"></div> <div class="chart-bar actual svelte-31511h"></div></div> <span class="chart-label svelte-31511h"> </span></div>'),Ma=x('<div class="chart svelte-31511h"><div class="chart-bars svelte-31511h"></div></div>');function Fa(e,a){var t=Ma(),r=p(t);Oe(r,21,()=>a.days,Ke,(o,s)=>{var i=Da();let l;var u=p(i),n=p(u);g(u);var v=b(u,2),h=b(p(v),2);g(v);var d=b(v,2),_=p(d,!0);g(d),g(i),K(c=>{l=Le(i,1,"chart-day svelte-31511h",null,l,{"is-today":f(s).isToday}),M(n,`${f(s).percentage??""}%`),xa(h,`--pct: ${c??""}`),M(_,f(s).label)},[()=>Math.min(f(s).percentage/100,1.2)]),E(o,i)}),g(r),g(t),E(e,t)}var Ia=x('<span class="card-number svelte-8c37im"> </span> <span class="card-unit svelte-8c37im">Kg</span>',1),Ka=x('<span class="card-placeholder svelte-8c37im">—</span>'),Oa=x('<p><span class="arrow"> </span> </p>'),La=x('<div class="card weight-card svelte-8c37im"><div class="card-head svelte-8c37im"><span class="card-title svelte-8c37im">Current Weight</span> <button type="button" class="card-action svelte-8c37im" aria-label="Edit weight">⚡</button></div> <p class="card-value svelte-8c37im"><!></p> <!></div>');function Ha(e,a){J(a,!0);const t=U(()=>{if(a.weight==null||a.previousWeight==null||a.previousWeight<=0)return{text:"",down:!0};const d=a.weight-a.previousWeight,_=Math.round(d/a.previousWeight*1e4)/100;return{text:`${d>=0?"+":""}${d.toFixed(1)} (${_>=0?"+":""}${_}%)`,down:d<0}});var r=La(),o=p(r),s=b(p(o),2);g(o);var i=b(o,2),l=p(i);{var u=d=>{var _=Ia(),c=ne(_),y=p(c,!0);g(c),le(2),K(m=>M(y,m),[()=>a.weight.toFixed(2)]),E(d,_)},n=d=>{var _=Ka();E(d,_)};H(l,d=>{a.weight!=null?d(u):d(n,!1)})}g(i);var v=b(i,2);{var h=d=>{var _=Oa();let c;var y=p(_),m=p(y,!0);g(y);var k=b(y);g(_),K(()=>{c=Le(_,1,"card-change svelte-8c37im",null,c,{down:f(t).down,up:!f(t).down}),M(m,f(t).down?"↓":"↑"),M(k,` ${f(t).text??""}`)}),E(d,_)};H(v,d=>{f(t).text&&d(h)})}g(r),V("click",s,function(...d){a.onEditClick?.apply(this,d)}),E(e,r),G()}$(["click"]);var Ra=x('<p class="card-change svelte-1y4i54y"><span class="arrow">↓</span> </p>'),Ya=x('<div class="card calories-card svelte-1y4i54y"><p class="card-title svelte-1y4i54y">Calories</p> <p class="card-value svelte-1y4i54y"><span class="card-number svelte-1y4i54y"> </span> <span class="card-unit svelte-1y4i54y">Kcal</span></p> <!></div>');function Ua(e,a){J(a,!0);let t=ya(a,"trendPct",3,null);var r=Ya(),o=b(p(r),2),s=p(o),i=p(s,!0);g(s),le(2),g(o);var l=b(o,2);{var u=n=>{var v=Ra(),h=b(p(v));g(v),K(d=>M(h,` ${d??""}%`),[()=>Math.abs(t()).toFixed(1)]),E(n,v)};H(l,n=>{t()!=null&&n(u)})}g(r),K(n=>M(i,n),[()=>a.calories.toLocaleString()]),E(e,r),G()}var za=x('<div class="backdrop svelte-1wk5kq2" role="dialog" aria-modal="true" aria-label="Settings"><div class="modal svelte-1wk5kq2"><div class="modal-head svelte-1wk5kq2"><h2 class="modal-title svelte-1wk5kq2">Settings</h2> <button type="button" class="modal-close svelte-1wk5kq2" aria-label="Close">×</button></div> <div class="modal-body svelte-1wk5kq2"><label class="field svelte-1wk5kq2"><span class="field-label svelte-1wk5kq2">Daily allowance (Kcal)</span> <input type="number" class="field-input svelte-1wk5kq2" min="1"/></label> <label class="field svelte-1wk5kq2"><span class="field-label svelte-1wk5kq2">Current weight (Kg)</span> <input type="number" class="field-input svelte-1wk5kq2" step="0.01" min="0" placeholder="—"/></label> <p class="field-hint svelte-1wk5kq2">Updating weight saves the previous value so the card can show change %.</p></div></div></div>');function Pa(e,a){J(a,!0);let t=P(2267),r=P("");ma(()=>{a.open&&(C(t,a.dailyAllowance,!0),C(r,a.currentWeight!=null?String(a.currentWeight):"",!0))});function o(){const v=Number(f(t));!Number.isNaN(v)&&v>0&&a.onSaveAllowance(v)}function s(){const v=parseFloat(f(r));!Number.isNaN(v)&&v>0?a.onUpdateWeight(v):f(r)===""&&a.onSaveWeight(null)}function i(){o(),s(),a.onClose()}var l=De(),u=ne(l);{var n=v=>{var h=za(),d=p(h),_=p(d),c=b(p(_),2);g(_);var y=b(_,2),m=p(y),k=b(p(m),2);te(k),g(m);var w=b(m,2),q=b(p(w),2);te(q),g(w),le(2),g(y),g(d),g(h),V("click",c,i),xe("blur",k,o),re(k,()=>f(t),A=>C(t,A)),xe("blur",q,s),re(q,()=>f(r),A=>C(r,A)),E(v,h)};H(u,v=>{a.open&&v(n)})}E(e,l),G()}$(["click"]);var Va=x('<p class="field-error svelte-1f5ecsq"> </p>'),Ba=x('<div class="backdrop svelte-1f5ecsq" role="dialog" aria-modal="true" aria-label="Add entry"><div class="modal svelte-1f5ecsq"><div class="modal-head svelte-1f5ecsq"><h2 class="modal-title svelte-1f5ecsq">Add entry</h2> <button type="button" class="modal-close svelte-1f5ecsq" aria-label="Close">×</button></div> <div class="modal-body svelte-1f5ecsq"><label class="field svelte-1f5ecsq"><span class="field-label svelte-1f5ecsq">Calories *</span> <input type="number" class="field-input svelte-1f5ecsq" min="1" required=""/></label> <label class="field svelte-1f5ecsq"><span class="field-label svelte-1f5ecsq">Protein (optional)</span> <input type="number" class="field-input svelte-1f5ecsq" min="0" step="1"/></label> <!> <div class="modal-actions svelte-1f5ecsq"><button type="button" class="btn btn-secondary svelte-1f5ecsq">Cancel</button> <button type="button" class="btn btn-primary svelte-1f5ecsq">Add</button></div></div></div></div>');function Ja(e,a){J(a,!0);let t=P(""),r=P(""),o=P("");function s(){C(o,"");const v=Number(f(t)),h=Number(f(r))||0;if(Number.isNaN(v)||v<=0){C(o,"Calories must be greater than 0");return}if(Number.isNaN(h)||h<0){C(o,"Protein must be 0 or greater");return}a.onAdd({calories:v,protein:h}),C(t,""),C(r,""),a.onClose()}function i(){C(t,""),C(r,""),C(o,""),a.onClose()}var l=De(),u=ne(l);{var n=v=>{var h=Ba(),d=p(h),_=p(d),c=b(p(_),2);g(_);var y=b(_,2),m=p(y),k=b(p(m),2);te(k),g(m);var w=b(m,2),q=b(p(w),2);te(q),g(w);var A=b(w,2);{var D=S=>{var R=Va(),X=p(R,!0);g(R),K(()=>M(X,f(o))),E(S,R)};H(A,S=>{f(o)&&S(D)})}var W=b(A,2),F=p(W),T=b(F,2);g(W),g(y),g(d),g(h),V("click",c,i),re(k,()=>f(t),S=>C(t,S)),re(q,()=>f(r),S=>C(r,S)),V("click",F,i),V("click",T,s),E(v,h)};H(u,v=>{a.open&&v(n)})}E(e,l),G()}$(["click"]);const He="calories-intake",Re="calories-settings",Ga={dailyAllowance:2267,currentWeight:null,previousWeight:null};function Ye(e,a){if(typeof window>"u")return a;try{const t=localStorage.getItem(e);return t?JSON.parse(t):a}catch{return a}}function Ue(e,a){if(!(typeof window>"u"))try{localStorage.setItem(e,JSON.stringify(a))}catch{}}function j(){return Ye(He,{})}function Xa(e){return j()[e]??[]}function Za(e,a){const t=j(),r=t[e]??[];t[e]=[...r,a],Ue(He,t)}function z(){return Ye(Re,Ga)}function me(e){const t={...z(),...e};Ue(Re,t)}function Qa(e){me({dailyAllowance:e})}function ja(e){const a=z();me({previousWeight:a.currentWeight,currentWeight:e})}function $a(){const{subscribe:e,set:a,update:t}=Ie(j());return{subscribe:e,reload:()=>a(j()),addEntry:(r,o)=>{Za(r,o),a(j())}}}const Te=$a();function et(){const{subscribe:e,set:a,update:t}=Ie(z());return{subscribe:e,reload:()=>a(z()),setDailyAllowance:r=>{Qa(r),t(o=>({...o,dailyAllowance:r}))},setCurrentWeight:r=>{me({...z(),currentWeight:r}),a(z())},updateWeight:r=>{ja(r),a(z())}}}const ae=et();function at(e){const a=e.getDay(),t=e.getDate()-a+(a===0?-6:1);return new Date(e.getFullYear(),e.getMonth(),t)}function be(e){const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${a}-${t}-${r}`}const tt=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function rt(e,a){const t=new Date,r=at(t),o=be(t),s=[];for(let i=0;i<7;i++){const l=new Date(r);l.setDate(r.getDate()+i);const u=be(l),v=(a?.[u]??Xa(u)).reduce((d,_)=>d+_.calories,0),h=e>0?Math.round(v/e*100):0;s.push({label:tt[i],dateKey:u,calories:v,percentage:h,isToday:u===o})}return s}var lt=x('<p class="entry-list-empty svelte-1uha8ag">No entries yet. Tap + to add.</p>'),nt=x('<li class="entry-item svelte-1uha8ag"> <!></li>'),st=x('<ul class="entry-list-items svelte-1uha8ag"></ul>'),it=x(`<div class="dashboard"><!> <!> <!> <div class="cards svelte-1uha8ag"><!> <!></div> <section class="entry-list svelte-1uha8ag" aria-label="Today's entries"><h2 class="entry-list-title svelte-1uha8ag">Today's entries</h2> <!></section></div> <button type="button" class="fab svelte-1uha8ag" aria-label="Add entry">+</button> <!> <!>`,1);function ht(e,a){J(a,!0);const t=()=>qe(Te,"$entriesStore",o),r=()=>qe(ae,"$settingsStore",o),[o,s]=wa();let i=P(!1),l=P(!1);const u=U(t),n=U(r),v=U(()=>be(new Date)),h=U(()=>f(u)[f(v)]??[]),d=U(()=>f(h).reduce((N,Y)=>N+Y.calories,0)),_=U(()=>rt(f(n).dailyAllowance,f(u)));function c(){C(i,!0)}function y(){C(l,!0)}function m(N){Te.addEntry(f(v),N)}var k=it(),w=ne(k),q=p(w);Na(q,{onMenuClick:c});var A=b(q,2);Ta(A,{get totalCalories(){return f(d)},get dailyAllowance(){return f(n).dailyAllowance}});var D=b(A,2);Fa(D,{get days(){return f(_)}});var W=b(D,2),F=p(W);Ha(F,{get weight(){return f(n).currentWeight},get previousWeight(){return f(n).previousWeight},onEditClick:c});var T=b(F,2);Ua(T,{get calories(){return f(d)},trendPct:null}),g(W);var S=b(W,2),R=b(p(S),2);{var X=N=>{var Y=lt();E(N,Y)},ze=N=>{var Y=st();Oe(Y,21,()=>f(h),Ke,(Ve,se)=>{var ie=nt(),ke=p(ie),Be=b(ke);{var Je=oe=>{var Se=Ge();K(()=>M(Se,`· ${f(se).protein??""}g protein`)),E(oe,Se)};H(Be,oe=>{f(se).protein>0&&oe(Je)})}g(ie),K(()=>M(ke,`${f(se).calories??""} Kcal `)),E(Ve,ie)}),g(Y),E(N,Y)};H(R,N=>{f(h).length===0?N(X):N(ze,!1)})}g(S),g(w);var ye=b(w,2),we=b(ye,2);Pa(we,{get open(){return f(i)},get dailyAllowance(){return f(n).dailyAllowance},get currentWeight(){return f(n).currentWeight},onClose:()=>C(i,!1),onSaveAllowance:N=>ae.setDailyAllowance(N),onSaveWeight:N=>ae.setCurrentWeight(N),onUpdateWeight:N=>ae.updateWeight(N)});var Pe=b(we,2);Ja(Pe,{get open(){return f(l)},onClose:()=>C(l,!1),onAdd:m}),V("click",ye,y),E(e,k),G(),s()}$(["click"]);export{ht as component};
